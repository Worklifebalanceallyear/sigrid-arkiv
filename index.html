<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sigrid Riise Arkiv</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #05070a; color: #f0f0f0; -webkit-font-smoothing: antialiased; }
        .glass-header { background: rgba(13, 17, 23, 0.95); backdrop-filter: blur(10px); border-bottom: 1px solid #30363d; }
        .episode-card { background: #161b22; border: 1px solid #30363d; transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); }
        .episode-card:active { transform: scale(0.98); background: #1c2128; }
        .btn-blue { background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); }
    </style>
</head>
<body>

    <header class="glass-header sticky top-0 z-50 p-6">
        <div class="max-w-xl mx-auto flex flex-col gap-4">
            <div class="flex justify-between items-center">
                <h1 class="text-2xl font-black italic tracking-tighter uppercase">SR <span class="text-blue-500">Arkiv</span></h1>
                <div id="counter" class="text-[10px] font-mono font-bold bg-blue-500/10 text-blue-400 px-3 py-1 rounded-full border border-blue-500/20 uppercase tracking-widest text-center">Indlæser...</div>
            </div>
            <input type="text" id="search" oninput="runSearch()" placeholder="Søg i 500+ afsnit (år eller emne)..." 
                   class="w-full bg-[#0d1117] border border-[#30363d] rounded-2xl p-4 text-white focus:ring-2 focus:ring-blue-600 outline-none transition-all shadow-inner">
        </div>
    </header>

    <main id="app" class="max-w-xl mx-auto p-4 space-y-4 pb-32">
        </main>

    <script>
        let db = [];

        async function init() {
            try {
                const r = await fetch('data.json?v=' + Date.now());
                db = (await r.json()).reverse();
                document.getElementById('counter').innerText = db.length + " AFSNIT";
                render(db);
            } catch (e) {
                document.getElementById('app').innerHTML = "Kunne ikke indlæse data.json";
            }
        }

        function render(list) {
            const app = document.getElementById('app');
            app.innerHTML = list.map(item => {
                const day = item.timestamp;
                // MEKANISME: Den absolutte filter-URL
                const filterRaw = `startTime:[${day}T00:00:00Z TO ${day}T23:59:59Z]`;
                const finalUrl = `https://www.kb.dk/find-materiale/dr-arkivet/find?q=sigrid+riise&filter=${encodeURIComponent(filterRaw)}`;

                return `
                <div class="episode-card p-6 rounded-[2rem] shadow-xl">
                    <div class="flex items-center gap-2 mb-3">
                        <span class="text-[11px] font-black text-blue-500 tracking-[0.2em] uppercase italic">${day}</span>
                    </div>
                    <h2 class="text-xl font-bold text-white mb-2 tracking-tight">${item.title}</h2>
                    <p class="text-sm text-gray-400 mb-6 font-light leading-relaxed">${item.description}</p>
                    <a href="${finalUrl}" target="_blank" 
                       class="btn-blue block w-full text-center py-4 rounded-2xl font-black text-sm uppercase tracking-widest text-white shadow-lg">
                       Find hos KB
                    </a>
                </div>
            `}).join('');
        }

        function runSearch() {
            const q = document.getElementById('search').value.toLowerCase();
            render(db.filter(i => i.timestamp.includes(q) || i.description.toLowerCase().includes(q) || i.title.toLowerCase().includes(q)));
        }

        init();
    </script>
</body>
</html>
